<!--<link rel="import" href="../bower_components/polymer/polymer.html">-->

<link rel="import" href="../lib/jsorolla/src/lib/components/jso-help-menu.html">
<link rel="import" href="../lib/jsorolla/src/lib/components/opencga/jso-opencga-header.html">
<link rel="import" href="../lib/jsorolla/src/lib/components/opencga/jso-opencga-footer.html">


<link rel="import" href="pvs-content.html">
<link rel="import" href="pvs-menubar.html">
<link rel="import" href="pvs-home.html">
<link rel="import" href="pvs-search-element.html">
<!--<link rel="import" href="pvs-studies-browser-element.html">-->
<!--<link rel="import" href="pvs-stats-element.html">-->
<!--<link rel="import" href="pvs-home.html">-->
<!--<link rel="import" href="pvs-menu.html">-->

<dom-module id="pvs-element">
    <style>
        :host {
            display: block;
            position: relative;
            cursor: default;
            font-size: 13px;
            height: 100%;
            background-color: var(--default-primary-color);
        }

        #sidemenu > div {
            font-size: 18px;
            box-sizing: border-box;
            padding: 7px 20px;
            border-bottom: 1px solid var(--divider-color);
        }

        #sidemenu > div:hover {
            cursor: pointer;
            background-color: var(--accent-color);
        }

        #sidemenu > div[active] {
            font-weight: normal;
        }

        div.icon {
            margin-left: 15px;
        }

        div.menu-button {
            padding: 0 10px;
        }

        div.menu-button:hover {
            background-color: rgba(0, 0, 0, 0.20);
        }

        #content {
            background-color: inherit;
            position: absolute;
            top: 60px;
            width: 100%;

            height: calc(100% - 60px);
            overflow-y: auto;

        }

        @media (max-width: 1100px) {
            .option-text {
                display: none;
            }
        }

        .userid {
            color: var(--accent-color);
            font-size: 16px;
        }

        jso-opencga-header {
            position: absolute;
            top: 0;
        }

        jso-opencga-footer {
            position: absolute;
            bottom: 0;
        }

    </style>
    <template>

        <pvs-content id="content" selected-option="{{selectedOption}}">
            <pvs-home data-option="home" hidden$="{{computeHome(selectedOption)}}"
                      selected-option="{{selectedOption}}"></pvs-home>
            <pvs-search-element diseases="{{diseases}}" id="pvsSearchElement"></pvs-search-element>
        </pvs-content>

        <jso-opencga-header id="jsoHeader"
                            selected-option="{{selectedOption}}"
                            allow-login="false">
            <div class="icon">
                <img src="images/bier-text.svg" style="height: 50px;margin: 5px 0px 0 0;">
            </div>
            <span class="title">CIBERER Spanish Variant Server</span>
            <span class="description"></span>

            <pvs-menubar class="menu" id="teamMenuBar" selected-option="{{selectedOption}}">
                <div title="Search" class="hover" data-option="search" data-menu-type="unique">
                    <i class="fa fa-search"></i>
                    <span class="option-text">Search</span>
                </div>
            </pvs-menubar>

            <jso-help-menu class="helpmenu" selectedOption="{{selectedOption}}">
                <a href="https://github.com/babelomics/pvs/wiki" target="_blank">
                    <i class="fa fa-book"></i>
                    &nbsp; Documentation
                </a>
                <a href="https://github.com/babelomics/pvs/wiki/tutorial" target="_blank">
                    <i class="fa fa-compass"></i>
                    &nbsp; Tutorial
                </a>
                <a href="https://github.com/babelomics/pvs/" target="_blank">
                    <i class="fa fa-github"></i>
                    &nbsp; Source code
                </a>
            </jso-help-menu>
        </jso-opencga-header>


        <jso-opencga-footer hidden$="{{computeFooter(selectedOption)}}" menu-option="home">
            CSVS: created by Computational Genomics Department
            <br>
            Principe Felipe Research Center
            <br>
            2015
        </jso-opencga-footer>


        <!--<jso-header id="jsoHeader"-->
        <!--on-logout="{{handleLogout}}"-->
        <!--selectedOption="{{selectedOption}}"-->
        <!--allowLogin="false"-->
        <!--showMenu="true">-->
        <!--<div class="title">CIBERER Spanish Variant Server</div>-->
        <!--<div class="description">1.0.1</div>-->
        <!--<pvs-menu class="menu" selectedOption="{{selectedOption}}"></pvs-menu>-->

        <!--<jso-help-menu class="helpmenu" selectedOption="{{selectedOption}}">-->
        <!--<div class="link">-->
        <!--<font-awesome icon="book"></font-awesome>-->
        <!--<a class="a" href="https://github.com/babelomics/pvs/wiki" target="_blank">-->
        <!--&nbsp; Documentation-->
        <!--</a>-->
        <!--</div>-->
        <!--<div class="link">-->
        <!--<font-awesome icon="compass"></font-awesome>-->
        <!--<a class="a" href="https://github.com/babelomics/pvs/wiki/Tutorial" target="_blank">-->
        <!--&nbsp; Tutorial-->
        <!--</a>-->
        <!--</div>-->
        <!--<div class="link">-->
        <!--<font-awesome icon="github"></font-awesome>-->
        <!--<a class="a" href="https://github.com/babelomics/pvs/" target="_blank">-->
        <!--&nbsp; Source code-->
        <!--</a>-->
        <!--</div>-->
        <!--</jso-help-menu>-->
        <!--</jso-header>-->

        <!--<div id="content">-->
        <!--<template if="{{ selectedOption == 'home' || selectedOption == 'none' || selectedOption == ''}}">-->
        <!--<pvs-home selectedOption="{{selectedOption}}"></pvs-home>-->
        <!--</template>-->
        <!--<template if="{{ selectedOption == 'search' }}">-->
        <!--<es-search-element diseases="{{ diseases }}" id="pvsSearchElement"></es-search-element>-->
        <!--</template>-->

        <!--<template if="{{ selectedOption == 'studies' }}">-->
        <!--<es-studies-browser-element studies="{{ studies }}"></es-studies-browser-element>-->
        <!--</template>-->
        <!--<template if="{{ selectedOption == 'stats' }}">-->
        <!--<es-stats-element studies="{{ studies }}"></es-stats-element>-->
        <!--</template>-->
        <!--</div>-->

    </template>
</dom-module>
<script>
    Polymer({
        is: 'pvs-element',
        properties: {
            selectedOption: {
                type: String,
                value: "search",
                notify: true,
                reflectToAttribute: true,
                observer: 'selectedOptionChanged'
            },
            diseases: {
                type: Array,
                value: function () {
                    return [];
                }
            }
        }, created: function () {
//            this.diseases = [];
        },
        ready: function () {
            this.getDiseases();
        },
        getDiseases: function (event, response) {
            var me = this;
            PVSManager.diseases.list({
                request: {
                    async: false,
                    success: function (response) {
                        try {
                            var diseases = [];

                            for (var i = 0; i < response.result.length; i++) {
                                var elem = response.result[i];
                                diseases.push(elem);
                            }
                            me.diseases = diseases;
                        } catch (err) {
                            console.log("Error loading diseases: " + err);
                            me.diseases = [];
                        }
                    },
                    error: function (response) {
                        console.log("ERROR downloading diseases");
                        console.log(response);
                    }
                }
            });
        },
        computeFooter: function () {
            return this.selectedOption != "home";
        },
        computeHome: function () {
            return this.selectedOption != "home";
        },
        selectedOptionChanged: function (neo, old) {

            console.log(neo);
        },
    });
</script>
